<!DOCTYPE html>
<html lang="en">

<head>
    <!--HEADER-->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"></script>
    <script defer src="../../node_modules/swup/dist/swup.min.js"></script>
    <script defer src="../../public/scripts/scripts.js"></script>
    
    <link rel="stylesheet" href="../../public/stylesheets/styles.css">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- ADD FONTS-->

    <style>
      html {
        font-family: 'Roboto', sans-serif;
      } body {
        background-color: #11BFC7;
        /*background-image: linear-gradient(to bottom, #11BFC7, #47E2D6);*/
      } 
    </style>

</head>

<!--INFO:
MUDIT (MATT) JAIN
SKIP THE LINE
FRIDAY, APRIL 10, 2020
-->   

<body style="align-content: center; align-items: center;">
  <main id="swup" class="transition-wipe">      

        <div class="container-fluid">

        <div class="header">
          <h1 style="text-align:center;">SKIP THE LINE</h1>
          </div>





          
      <!-- NAVBAR -->
        <br>
        <nav class="navbar-custom navbar-expand">
          <u1 class="navbar-nav">
            <li class="nav-item">
              <a class="nav-link" href="/order_now" style="padding-left:25px">Order Now</a>
            </li>

            <li class="nav-item">
              <a class="nav-link" href="/pending_orders" style="padding-left:20px">Pending Orders</a>
            </li>
              
            <li class="nav-item">
              <a class="nav-link" href="/order_history" style="padding-left:20px">Order History</a>
            </li>
            <li class="nav-item logout"> <!--add css to logout class to align right-->
              <form method="POST" action="/logout">
                <input type="submit" value="logout">
              </form>
            </li>

          </u1>
        </nav>  
        <div class='loginbox' style='margin-top: 50px;'>   
          <br>
          <h2 style="text-align: center;">What date are you ordering for?</h2>
          
      <!-- DATE TABLE -->
          <p>
          <form action="/dickomode">
            <select name="drake" id="donald">
              <option value="a">hes in love with who i am</option>
              <option value="b">back in high school I used to jerk him with my hands</option>
              <option value="c">now i hit that orgy sex with condoms in my hand</option>
              <option value="d">i did half a xan, now im poundin on my man</option>
              <option value="e">ok bye</option>
            </select>
          </p>
          <p>
            <input style='align-self: center' type="submit" value="click to get hiv">
          
          </p>
        </form> 
        </div>  
        <br>

        <div class='loginbox' style='width: 90vw;margin-top: 30px;'>
          <h2 style="text-align: center;">Food</h2>
          <table style='text-align: center;'>
            <tr style='text-align: center;'>
      <!-- FOOD OPTIONS -->
              <td>
              <div class="card" style="width:1/3fr">
                <div class="card-header">hehehe</div>
                <img class="card-img-top" src="COOKIE.png">
                <div class="card-body">$69.69</div>
                <div class="card-footer">
                  <!--quantity + add to cart-->  
          

          
                        <!-- <form method="POST" action="/add_to_cart">
                          <input type="submit" value="Add">
                        < /form> -->
                        <div class="box">
                        <a class="button" href="#popup1">Add to cart</a>
                        </div>
                        <div id="popup1" class="overlay">
                          <div class="popup">
                            <h2>Quantity</h2>
                            <a class="close" href="#">&times;</a>
                            <div class="content">
                              <input type="number" step="1" min="0" name="menuItemQuantity" id="aa" placeholder="0">
                              <button onclick="add_to_cart(1)" >Add to Cart</button>
                            </div>
                          </div>
                        </div>
                    
                      </div>
                    </div>
                  </div>
                
                </div>
              </div>
            </td>
          
            <td>
              <div class="card" style="width:1/3fr">
                <div class="card-header">hehehe</div>
                <img class="card-img-top" src="COOKIE.png">
                <div class="card-body">$69.69</div>
                <div class="card-footer">
                  <!--quantity + add to cart-->  
          

          
                        <!-- <form method="POST" action="/add_to_cart">
                          <input type="submit" value="Add">
                        < /form> -->
                        <div class="box">
                        <a class="button" href="#popup1">Add to cart</a>
                        </div>
                        <div id="popup1" class="overlay">
                          <div class="popup">
                            <h2>Quantity</h2>
                            <a class="close" href="#">&times;</a>
                            <div class="content">
                              <input type="number" step="1" min="0" name="menuItemQuantity" id="aa" placeholder="0">
                              <button onclick="add_to_cart(1)" >Add to Cart</button>
                            </div>
                          </div>
                        </div>
                    
                      </div>
                    </div>
                  </div>
                
                </div>
              </div>
            </td>
          <td>
              <div class="card" style="width:1/3fr">
                <div class="card-header">hehehe</div>
                <img class="card-img-top" src="COOKIE.png">
                <div class="card-body">$69.69</div>
                <div class="card-footer">
                  <!--quantity + add to cart-->  
          

          
                        <!-- <form method="POST" action="/add_to_cart">
                          <input type="submit" value="Add">
                        < /form> -->
                        <div class="box">
                        <a class="button" href="#popup1">Add to cart</a>
                        </div>
                        <div id="popup1" class="overlay">
                          <div class="popup">
                            <h2>Quantity</h2>
                            <a class="close" href="#">&times;</a>
                            <div class="content">
                              <input type="number" step="1" min="0" name="menuItemQuantity" id="aa" placeholder="0">
                              <button onclick="add_to_cart(1)" >Add to Cart</button>
                            </div>
                          </div>
                        </div>
                    
                      </div>
                    </div>
                  </div>
                
                </div>
              </div>
            </td>
              </tr>
              </table>
            </div>
        
            <!-- <div class="col">
              <div class="card" style="width:">
                <div class="card-header">
                  
                </div>
                <img class="card-img-top" src="COOKIE.png">
                <div class="card-body">$$$</div>
                <div class="card-footer">Put buttons here</div>
              </div>
            </div>

            <div class="col">
              <div class="card" style="width:">
                <div class="card-header">Item name</div>
                <img class="card-img-top" src="COOKIE.png">
                <div class="card-body">$$$</div>
                <div class="card-footer">Put buttons here</div>
              </div>
            </div>-->

          
          <div class='loginbox' style='margin-top: 30px;width: 90vw'>
          <table> 
            <tr>

          <br>
          <h2 style="text-align: center;">Drinks</h2>
          <td>
              <div class="card" style="width:1/3fr">
                <div class="card-header">hehehe</div>
                <img class="card-img-top" src="COOKIE.png">
                <div class="card-body">$69.69</div>
                <div class="card-footer">
                  <!--quantity + add to cart-->  
          

          
                        <!-- <form method="POST" action="/add_to_cart">
                          <input type="submit" value="Add">
                        < /form> -->
                        <div class="box">
                        <a class="button" href="#popup1">Add to cart</a>
                        </div>
                        <div id="popup1" class="overlay">
                          <div class="popup">
                            <h2>Quantity</h2>
                            <a class="close" href="#">&times;</a>
                            <div class="content">
                              <input type="number" step="1" min="0" name="menuItemQuantity" id="aa" placeholder="0">
                              <button onclick="add_to_cart(1)" >Add to Cart</button>
                            </div>
                          </div>
                        </div>
                    
                      </div>
                    </div>
                  </div>
                
                </div>
              </div>
            </td>
          <td>
              <div class="card" style="width:1/3fr">
                <div class="card-header">hehehe</div>
                <img class="card-img-top" src="COOKIE.png">
                <div class="card-body">$69.69</div>
                <div class="card-footer">
                  <!--quantity + add to cart-->  
          

          
                        <!-- <form method="POST" action="/add_to_cart">
                          <input type="submit" value="Add">
                        < /form> -->
                        <div class="box">
                        <a class="button" href="#popup1">Add to cart</a>
                        </div>
                        <div id="popup1" class="overlay">
                          <div class="popup">
                            <h2>Quantity</h2>
                            <a class="close" href="#">&times;</a>
                            <div class="content">
                              <input type="number" step="1" min="0" name="menuItemQuantity" id="aa" placeholder="0">
                              <button onclick="add_to_cart(1)" >Add to Cart</button>
                            </div>
                          </div>
                        </div>
                    
                      </div>
                    </div>
                  </div>
                
                </div>
              </div>
            </td>
        
          <td>
              <div class="card" style="width:1/3fr">
                <div class="card-header">hehehe</div>
                <img class="card-img-top" src="COOKIE.png">
                <div class="card-body">$69.69</div>
                <div class="card-footer">
                  <!--quantity + add to cart-->  
          

          
                        <!-- <form method="POST" action="/add_to_cart">
                          <input type="submit" value="Add">
                        < /form> -->
                        <div class="box">
                        <a class="button" href="#popup1">Add to cart</a>
                        </div>
                        <div id="popup1" class="overlay">
                          <div class="popup">
                            <h2>Quantity</h2>
                            <a class="close" href="#">&times;</a>
                            <div class="content">
                              <input type="number" step="1" min="0" name="menuItemQuantity" id="aa" placeholder="0">
                              <button onclick="add_to_cart(1)" >Add to Cart</button>
                            </div>
                          </div>
                        </div>
                    
                      </div>
                    </div>
                  </div>
                
                </div>
              </div>
            </td>
        <td>
              <div class="card" style="width:1/3fr">
                <div class="card-header">hehehe</div>
                <img class="card-img-top" src="COOKIE.png">
                <div class="card-body">$69.69</div>
                <div class="card-footer">
                  <!--quantity + add to cart-->  
          

          
                        <!-- <form method="POST" action="/add_to_cart">
                          <input type="submit" value="Add">
                        < /form> -->
                        <div class="box">
                        <a class="button" href="#popup1">Add to cart</a>
                        </div>
                        <div id="popup1" class="overlay">
                          <div class="popup">
                            <h2>Quantity</h2>
                            <a class="close" href="#">&times;</a>
                            <div class="content">
                              <input type="number" step="1" min="0" name="menuItemQuantity" id="aa" placeholder="0">
                              <button onclick="add_to_cart(1)" >Add to Cart</button>
                            </div>
                          </div>
                        </div>
                    
                      </div>
                    </div>
                  </div>
                
                </div>
              </div>
            </td>
        </tr>
        </table>
        </div>
        <div class='loginbox' style='margin-top: 20px;'>   
        <form id="confirmOrderForm">
          <input id="cart_items" name="cart_items" type="hidden" value=''>
          <input type="submit" value="Confirm Order">
        </form>
      </div>
    </main>  
</body>

<script>
  var cart = {"cart_items": [], "item_amount": 0};
  
  function add_to_cart(i) {
    var menuItemName = document.getElementById('menuItemName' + i.toString()).textContent;
    var menuItemPrice = document.getElementById("menuItemPrice" + i.toString()).textContent;
    var menuItemQuantity = document.getElementById("menuItemQuantity" + i.toString()).value;
    console.log("menu item name = " + menuItemName);
    console.log("menu item price = " + menuItemPrice);
    console.log("menu item quantity = " + menuItemQuantity);
    
    var itemObject = {"item":"", "price": 0, "quantity": 0};
    var existsFlag = false;

    for (var n = 0; n < cart.item_amount; n++) {
      if (cart.cart_items[n].item == menuItemName) {
        var itemQuantity = parseInt(cart.cart_items[n].quantity);
        itemQuantity += parseInt(menuItemQuantity);
        itemQuantity = itemQuantity.toString();
        cart.cart_items[n].quantity = itemQuantity;
        existsFlag = true;
        break;
      }
    }

    if (existsFlag == false) {
      itemObject.item = menuItemName;
      itemObject.price = menuItemPrice;
      itemObject.quantity = menuItemQuantity;

      cart.cart_items[cart.item_amount] = itemObject;
      cart.item_amount++;
    }

    console.log(itemObject);
    console.log(cart);

    document.getElementById("cart_items").value = JSON.stringify(cart);

  }

  function sendData() {
    var cart_items = {
      value: document.getElementById("cart_items").value
    }
    var xhr = new window.XMLHttpRequest();
    xhr.open('POST', '/confirm_order', true);
    xhr.setRequestHeader('Content-Type', 'application/json;charset=UTF-8');
    xhr.send(JSON.stringify(cart_items));
  }
 
  // Access the form element...
  const form = document.getElementById( "confirmOrderForm" );

  // ...and take over its submit event.
  form.addEventListener( "submit", function ( event ) {
    event.preventDefault();
    if (cart.item_amount == 0) {
      alert("There are no items in the cart!");
    }
    else {
      sendData();
      console.log("order sent");
      window.location.replace(window.location.origin+"/confirm_order");
    }
    
  } );

</script>

</html>

